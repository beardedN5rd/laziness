---
 - name: install requirements for docker
   apt: name={{ item }} state=present
   with_items:
       - apt-transport-https
       - ca-certificates
       - linux-image-extra-virtual
       - python-pip
       - python3-pip

 -  name: add docker repo
    args:
      executable: /bin/bash
    shell: |
      apt-key adv --keyserver hkp://p80.pool.sks-keyservers.net:80 --recv-keys 58118E89F3A912897C070ADBF76221572C52609D
      sh -c 'echo "deb https://apt.dockerproject.org/repo ubuntu-xenial main" > /etc/apt/sources.list.d/docker.list'
      apt-get update
      apt-get purge lxc-docker
      apt-get upgrade
      apt-get update
      apt-get install -y linux-image-extra-$(uname -r)

 - name: install docker
   apt: name={{ item }} state=present
   with_items:
       - docker-engine

# -  name: install docker-compose
#    args:
#      executable: /bin/bash
#    shell: |
#      pip install docker-compose

 - name: install lxd
   apt: name={{ item }} state=present
   with_items:
       - lxd
